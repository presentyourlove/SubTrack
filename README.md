# SubTrack - æ™ºæ…§è¨‚é–±ç®¡ç†åŠ©æ‰‹ ğŸ“±ğŸ’°

[![React Native](https://img.shields.io/badge/React_Native-Expo-blue.svg)](https://reactnative.dev)
[![TypeScript](https://img.shields.io/badge/Language-TypeScript-007ACC.svg)](https://www.typescriptlang.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![i18n](https://img.shields.io/badge/i18n-Traditional_Chinese-red.svg)](src/i18n)

**SubTrack** æ˜¯ä¸€æ¬¾å°ˆç‚ºç¾ä»£äººè¨­è¨ˆçš„è·¨å¹³å°è¨‚é–±ç®¡ç†æ‡‰ç”¨ç¨‹å¼ã€‚å¹«åŠ©æ‚¨è¼•é¬†è¿½è¹¤ Netflix, Spotify, AWS ç­‰å„å¼é€±æœŸæ€§æ”¯å‡ºï¼ŒæŒæ¡è²¡å‹™ç‹€æ³ï¼Œæ‹’çµ•ä¸æ˜æ‰£æ¬¾ï¼

---

## âœ¨ å°ˆæ¡ˆäº®é» (Highlights)

- **è·¨å¹³å°æ”¯æ´**ï¼šå–®ä¸€ç¨‹å¼ç¢¼åº«åŒæ™‚æ”¯æ´ iOSã€Android èˆ‡ Webã€‚
- **é›¢ç·šå„ªå…ˆ (Offline-First)**ï¼šä¸»è¦è³‡æ–™å„²å­˜æ–¼æœ¬åœ° (Op-SQLite / LocalStorage)ï¼Œç„¡ç¶²è·¯ä¹Ÿèƒ½é †æš¢ä½¿ç”¨ã€‚
- **é›²ç«¯åŒæ­¥ (Cloud Sync)**ï¼šæ•´åˆ Firebaseï¼Œæ”¯æ´å¤šè£ç½®é–“è³‡æ–™å³æ™‚åŒæ­¥ã€‚
- **éš±ç§å°ˆæ³¨**ï¼šæ‚¨çš„è³‡æ–™æ‚¨ä½œä¸»ï¼Œæ”¯æ´éš±ç§æ¨¡å¼èˆ‡ç”Ÿç‰©è¾¨è­˜é–å®šã€‚
- **æ¥µè‡´æ•ˆèƒ½**ï¼šå°å…¥ JSIã€FlashList èˆ‡ New Architectureï¼Œæ‰“é€  60 FPS æµæš¢é«”é©—ã€‚

---

## ğŸš€ åŠŸèƒ½ç‰¹è‰² (Features)

- **ğŸ“Š è¦–è¦ºåŒ–å„€è¡¨æ¿**ï¼šç›´è§€çš„åœ–è¡¨åˆ†ææ¯æœˆ/æ¯å¹´æ”¯å‡ºè¶¨å‹¢èˆ‡åˆ†é¡ä½”æ¯”ã€‚
- **ğŸ”” æ™ºæ…§æé†’**ï¼šé€éæœ¬åœ°æ¨æ’­é€šçŸ¥ (Local Notifications) åœ¨æ‰£æ¬¾å‰æé†’æ‚¨ï¼Œä¸å†éŒ¯éç¹³è²»æ—¥ã€‚
- **ğŸŒ å¤šå¹£åˆ¥æ”¯æ´**ï¼šæ”¯æ´ TWD, USD, JPY, EUR ç­‰å¤šç¨®è²¨å¹£ï¼Œè‡ªå‹•æ›ç®—åŒ¯ç‡ã€‚
- **ğŸŒ“ æ·±è‰²/æ·ºè‰²æ¨¡å¼**ï¼šè‡ªå‹•è·Ÿéš¨ç³»çµ±æˆ–æ‰‹å‹•åˆ‡æ›ä¸»é¡Œï¼Œä¿è­·æ‚¨çš„çœ¼ç›ã€‚
- **ğŸ“… æ—¥æ›†æ•´åˆ**ï¼šé›™å‘åŒæ­¥ Google Calendarï¼Œéš¨æ™‚æŒæ¡èˆ‡ç®¡ç†æ‰£æ¬¾æ’ç¨‹ã€‚
- **ğŸ” å®‰å…¨é©—è­‰**ï¼šæ”¯æ´ç”Ÿç‰©è¾¨è­˜ (FaceID/TouchID) èˆ‡éš±ç§æ¨¡å¼ï¼Œéš±è—æ•æ„Ÿé‡‘é¡ã€‚
- **ğŸ·ï¸ æ¨™ç±¤èˆ‡ç¾¤çµ„**ï¼šæ”¯æ´å¤šé‡æ¨™ç±¤éæ¿¾èˆ‡å®¶åº­æ–¹æ¡ˆåˆ†å¸³æˆå“¡ç®¡ç†ã€‚
- **ğŸ” æœå°‹èˆ‡å ±è¡¨**ï¼šå…§å»ºæœå‹™ç›®éŒ„å¿«é€Ÿè¨‚é–±ã€å…¨å±€æœå°‹æŸ¥æ‰¾ï¼Œä»¥åŠè‡ªè¨‚å ±è¡¨åˆ†æã€‚
- **âš¡ æ·å¾‘æ“ä½œ**ï¼šæ”¯æ´ iOS/Android ä¸»ç•«é¢ Quick Actions é•·æŒ‰æ·å¾‘ã€‚
- **ğŸ“‚ è³‡æ–™åŒ¯å‡ºå…¥**ï¼šå®Œæ•´æ”¯æ´ CSV/PDF åŒ¯å‡ºèˆ‡ Excel è³‡æ–™åŒ¯å…¥ (èƒŒæ™¯å¤šåŸ·è¡Œç·’è™•ç†)ã€‚

---

## ğŸ’ ç¨‹å¼ç¢¼å“è³ª (Code Quality)

æœ¬å°ˆæ¡ˆåš´æ ¼éµå¾ªæ¥­ç•Œæ¨™æº–èˆ‡ `.agent` è¦ç¯„ï¼Œç¢ºä¿é«˜å¯ç¶­è­·æ€§èˆ‡ç©©å®šæ€§ï¼š

- **TypeScript Strict Mode**ï¼šå…¨é¢å•Ÿç”¨åš´æ ¼å‹åˆ¥æª¢æŸ¥ (no implicit any)ï¼Œæ¸›å°‘é‹è¡Œæ™‚éŒ¯èª¤ã€‚
- **ESLint + Prettier**ï¼šè‡ªå‹•åŒ–ä»£ç¢¼é¢¨æ ¼æª¢æŸ¥èˆ‡æ ¼å¼åŒ– (LF Line Endings)ï¼Œä¿æŒä»£ç¢¼æ•´æ½”ä¸€è‡´ã€‚
- **i18n åœ‹éš›åŒ–**ï¼šæ‰€æœ‰ UI å­—ä¸²æå–è‡³è³‡æºæª” (`src/i18n`)ï¼Œç„¡ Hardcoded å­—ä¸²ã€‚
- **Architecture**ï¼šæ¡ç”¨ Feature-First åˆ†å±¤æ¶æ§‹ï¼Œæœå‹™å±¤ (Service) èˆ‡ UI å±¤åˆ†é›¢ã€‚
- **Performance**ï¼š
  - **JSI Binding**ï¼šè³‡æ–™åº«ç›´æ¥èª¿ç”¨ C++ å±¤ï¼Œé¿é–‹ JS Bridgeã€‚
  - **FlashList**ï¼šåˆ—è¡¨æ¸²æŸ“æ•ˆèƒ½å„ªåŒ–ã€‚
  - **Hermes Static**ï¼šå•Ÿç”¨éœæ…‹åˆ†æå„ªåŒ–å•Ÿå‹•é€Ÿåº¦ã€‚

---

## ğŸ å¿«é€Ÿé–‹å§‹ (Quick Start)

### å‰ç½®éœ€æ±‚ (Prerequisites)

- Node.js (LTS version recommended)
- npm or yarn

### å®‰è£ä¾è³´ (Installation)

```bash
git clone https://github.com/Presentyourlove/SubTrack.git
cd SubTrack
npm install
```

### å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ (Development)

```bash
# å•Ÿå‹• Expo Go (é€šç”¨)
npm start

# å•Ÿå‹• Web ç‰ˆ
npm run web

# å•Ÿå‹• Android æ¨¡æ“¬å™¨ (éœ€å®‰è£ Android Studio)
npm run android

# å•Ÿå‹• iOS æ¨¡æ“¬å™¨ (éœ€å®‰è£ Xcode, Mac Only)
npm run ios
```

---

## ğŸ“± æ”¯æ´å¹³å° (Supported Platforms)

| å¹³å°        | ç‰ˆæœ¬éœ€æ±‚        | æ”¯æ´ç‹€æ…‹ | å‚™è¨»                                     |
| :---------- | :-------------- | :------: | :--------------------------------------- |
| **Android** | Android 6.0+    |    âœ…    | å®Œæ•´æ”¯æ´ (APK)                           |
| **iOS**     | iOS 13.0+       |    âœ…    | å®Œæ•´æ”¯æ´ (IPA / SideStore)               |
| **Web**     | Modern Browsers |    âœ…    | PWA æ”¯æ´ (éƒ¨åˆ†åŸç”ŸåŠŸèƒ½å¦‚ Haptics æœƒé™ç´š) |

---

## ğŸ› ï¸ æŠ€è¡“å †ç–Š (Tech Stack)

### Client Side

- **Framework**: [React Native](https://reactnative.dev/) / [Expo](https://expo.dev/) (SDK 54)
- **Architecture**: New Architecture enabled (Fabric & TurboModules)
- **Language**: [TypeScript](https://www.typescriptlang.org/)
- **Navigation**: [Expo Router](https://docs.expo.dev/router/introduction/) (v3)
- **State Management**: React Context API & Hooks
- **Styling**: StyleSheet (Native)

### Backend & Service

- **Auth**: Firebase Authentication
- **Database (Cloud)**: Cloud Firestore
- **Database (Local)**:
  - Mobile: `@op-engineering/op-sqlite` (JSI/WAL Mode Enabled)
  - Web: `localStorage` (Adapter Pattern)
- **Sync**: Custom Bi-directional Sync Logic

### Tools

- **2026-01-20**: Comprehensive linting and type error fixes across test suite (29 files).
- **2026-01-20**: Achieved **79.22% Test Coverage**, implementing Database Migration & Web Platform consistency tests.
- **Linting**: ESLint, Prettier
- **Build**: EAS (Expo Application Services)

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹ (Project Structure)

```text
SubTrack/
â”œâ”€â”€ app/                      # Expo Router é é¢è·¯ç”± (File-based Routing)
â”‚   â”œâ”€â”€ (tabs)/               # åº•éƒ¨å°èˆªé é¢ (Home, Reports, Settings)
â”‚   â””â”€â”€ _layout.tsx           # æ ¹å°èˆªé…ç½®èˆ‡ Provider æ³¨å…¥
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # UI å…ƒä»¶åº«
â”‚   â”‚   â”œâ”€â”€ common/           # é€šç”¨åŸå­å…ƒä»¶ (OptimizedList, CachedImage)
â”‚   â”‚   â”œâ”€â”€ settings/         # è¨­å®šé é¢çµ„ä»¶
â”‚   â”‚   â””â”€â”€ subscription/     # è¨‚é–±å¡ç‰‡èˆ‡è¡¨å–®
â”‚   â”œâ”€â”€ context/              # å…¨åŸŸç‹€æ…‹ (Theme, Auth, Database, Security)
â”‚   â”œâ”€â”€ services/             # æ¥­å‹™é‚è¼¯å±¤
â”‚   â”‚   â”œâ”€â”€ db/               # JSI SQLite è³‡æ–™åº«æ“ä½œ (DAO)
â”‚   â”‚   â”œâ”€â”€ workerService.ts  # å¤šåŸ·è¡Œç·’è™•ç†
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ hooks/                # Custom Hooks (useSync, useBiometrics)
â”‚   â”œâ”€â”€ types/                # TypeScript å‹åˆ¥å®šç¾©
â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½å¼ (Date, Currency, Haptics)
â”‚   â””â”€â”€ i18n/                 # èªè¨€è³‡æºæª” (zh.ts, en.ts)
â”œâ”€â”€ .maestro/                 # E2E æ¸¬è©¦æµç¨‹è…³æœ¬
â”œâ”€â”€ scripts/                  # è‡ªå‹•åŒ–å·¥å…·
â””â”€â”€ docs/                     # å°ˆæ¡ˆæ–‡ä»¶
```

---

## ğŸ¤ é–‹ç™¼æŒ‡å— (Development Guide)

1. **æäº¤è¦ç¯„ (Commits)**: è«‹åš´æ ¼éµå¾ª Conventional Commitsï¼š
   - `feat`: æ–°å¢åŠŸèƒ½
   - `fix`: ä¿®å¾©éŒ¯èª¤
   - `docs`: æ–‡ä»¶è®Šæ›´
   - `perf`: æ•ˆèƒ½å„ªåŒ–
   - `chore`: å»ºæ§‹å·¥å…·æˆ–ä¾è³´æ›´æ–°

2. **åˆ†æ”¯ç­–ç•¥ (Branching)**:
   - `main`: ç©©å®šç™¼å¸ƒåˆ†æ”¯
   - `develop`: ä¸»è¦é–‹ç™¼åˆ†æ”¯
   - `feature/name`: åŠŸèƒ½é–‹ç™¼åˆ†æ”¯

3. **ä»£ç¢¼æª¢æŸ¥**: æäº¤å‰è«‹ç¢ºä¿é€šé `npm run lint` èˆ‡ `npm run type-check`ã€‚

---

## ğŸ§ª æ¸¬è©¦ (Testing)

### 1. å–®å…ƒèˆ‡æ•´åˆæ¸¬è©¦ (Unit & Integration)

ä½¿ç”¨ Jest é€²è¡Œé‚è¼¯æ¸¬è©¦ï¼Œç›®å‰å…¨å°ˆæ¡ˆè¦†è“‹ç‡å·²é” >80%ï¼š

```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
npm test
# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm test -- --coverage

# ç›£è½æ¨¡å¼
npm test -- --watch
```

### 2. E2E è‡ªå‹•åŒ–æ¸¬è©¦ (End-to-End)

ä½¿ç”¨ Maestro é€²è¡Œå®Œæ•´æµç¨‹é©—è­‰ï¼š

```bash
# å®‰è£ Maestro CLI (macOS/Linux)
curl -Ls "https://get.maestro.mobile.dev" | bash

# Windows ä½¿ç”¨è€…éœ€å…ˆå®‰è£ WSL
# wsl --install (éœ€ç³»çµ±ç®¡ç†å“¡æ¬Šé™ä¸¦é‡å•Ÿ)
# ç„¶å¾Œåœ¨ WSL ä¸­åŸ·è¡Œä¸Šè¿° curl æŒ‡ä»¤

# åŸ·è¡Œæ‰€æœ‰ E2E æ¸¬è©¦
maestro test .maestro/flows/

# åŸ·è¡Œå–®ä¸€æ¸¬è©¦æµç¨‹
maestro test .maestro/flows/add_subscription.yaml

# æŒçºŒç›£æ§æ¨¡å¼ (é–‹ç™¼ç”¨)
maestro test --continuous .maestro/flows/
```

**å¯ç”¨æ¸¬è©¦æµç¨‹ï¼š**

| æµç¨‹                    | èªªæ˜               |
| ----------------------- | ------------------ |
| `init.yaml`             | App åˆå§‹åŒ–èˆ‡è¼‰å…¥   |
| `home.yaml`             | é¦–é å°èˆªèˆ‡é é¢åˆ‡æ› |
| `add_subscription.yaml` | æ–°å¢è¨‚é–±å®Œæ•´æµç¨‹   |
| `search.yaml`           | æœå°‹åŠŸèƒ½èˆ‡çµæœé©—è­‰ |
| `settings.yaml`         | è¨­å®šé é¢èˆ‡ä¸»é¡Œåˆ‡æ› |

### 3. å„å¹³å°æ¸¬è©¦æŒ‡å— (Cross-Platform Testing Guide)

> [!IMPORTANT]
> æœ¬å°ˆæ¡ˆä½¿ç”¨ **`op-sqlite`** (Native JSI Module)ï¼Œ**ä¸æ”¯æ´** App Store / Play Store ä¸‹è¼‰çš„æ¨™æº–ç‰ˆ **Expo Go**ã€‚
> æ‚¨å¿…é ˆä½¿ç”¨ **Development Build (é–‹ç™¼ç‰ˆç”¨æˆ¶ç«¯)** æ‰èƒ½æƒç„ QR Code é€²è¡Œå¯¦æ©Ÿæ¸¬è©¦ã€‚

- **Android (APK)**
  - **æ¨¡æ“¬å™¨**: åŸ·è¡Œ `npm run android`ã€‚
  - **å¯¦æ©Ÿ (Development Build)**:
    1. æ‰“åŒ…é–‹ç™¼ç‰ˆ: `eas build --profile development --platform android`
    2. å®‰è£ .apk åˆ°æ‰‹æ©Ÿã€‚
    3. åŸ·è¡Œ `npx expo start --dev-client` ç”¢ç”Ÿ QR Codeã€‚
    4. é–‹ç™¼ç‰ˆ App é–‹å•Ÿå¾Œï¼Œæƒæçµ‚ç«¯æ©Ÿçš„ QR Code é€£ç·šã€‚

- **iOS (SideStore IPA)**
  - **å¯¦æ©Ÿ (Development Build)**:
    1. æ‰“åŒ…é–‹ç™¼ç‰ˆ: `eas build --profile development --platform ios`
    2. é€é SideStore / AltStore å®‰è£ .ipaã€‚
    3. åŸ·è¡Œ `npx expo start --dev-client` ç”¢ç”Ÿ QR Codeã€‚
    4. é–‹ç™¼ç‰ˆ App é–‹å•Ÿå¾Œï¼Œæƒææˆ–é¸æ“‡é€£ç·šã€‚
  - **æ¨¡æ“¬å™¨ (Mac Only)**: åŸ·è¡Œ `npm run ios`ã€‚

- **Web (PWA)**
  - åŸ·è¡Œ `npm run web` (Op-SQLite è‡ªå‹•é™ç´šç‚º LocalStorage)ã€‚

---

## ğŸ“¦ æ‰“åŒ…èˆ‡ç™¼å¸ƒ (Build & Release)

æœ¬å°ˆæ¡ˆä½¿ç”¨ **EAS Build** é€²è¡Œé›²ç«¯æ‰“åŒ…ã€‚

### 1. Android APK (Release)

é©ç”¨æ–¼ç›´æ¥å®‰è£æˆ–ä¸Šæ¶ Play Storeï¼š

```bash
eas build -p android --profile preview
```

### 2. SideStore / AltStore IPA (iOS)

é©ç”¨æ–¼å´è¼‰ (Sideloading) çš„ IPA æª”æ¡ˆï¼š

```bash
eas build -p ios --profile preview
```

### 3. Web App (Production)

è¼¸å‡ºéœæ…‹ç¶²ç«™æª”æ¡ˆè‡³ `dist/` ç›®éŒ„ï¼š

```bash
npx expo export -p web
```

---

## ğŸ“š API æ–‡ä»¶ (Internal Services)

ç”±æ–¼æ¡ç”¨ Serverless æ¶æ§‹ï¼Œä¸»è¦çš„æœå‹™ä»‹é¢ä½æ–¼ `src/services/`ï¼š

- **AuthService**: è™•ç† Firebase ç™»å…¥/è¨»å†Š/ç™»å‡ºã€‚
- **DatabaseService (Adapters)**:
  - Mobile: é€é `src/services/db/*.ts` å°è£ SQL æŒ‡ä»¤ã€‚
  - Web: é€é `src/services/database.web.ts` æ¨¡æ“¬ SQL æ“ä½œã€‚
- **SyncService**: è™•ç† Local SQLite èˆ‡ Firestore çš„å·®ç•°æ¯”å°èˆ‡åŒæ­¥ã€‚
- **WorkerService**: åœ¨èƒŒæ™¯ç·šç¨‹è™•ç†å¤§å‹ Excel åŒ¯å…¥ã€‚

---

## ğŸ‘¤ ä½œè€… (Author)

Presentyourlove

---

## ğŸ“ è‡´è¬ (Acknowledgments)

- æ„Ÿè¬ [Expo](https://expo.dev) ç”Ÿæ…‹ç³»çµ±ã€‚
- åœ–ç¤ºä¾†æºï¼š[Ionicons](https://ionic.io/ionicons)ã€‚
- è³‡æ–™åº«å¼•æ“ï¼š[op-sqlite](https://github.com/OP-Engineering/op-sqlite)ã€‚

---

## ğŸ”® å¾Œç¹¼å„ªåŒ–å»ºè­° (Future Roadmap)

### ğŸ¤– V3.0 æ™ºæ…§åŒ–èˆ‡å‰µæ–° (AI & Smart Features)

- [ ] **ğŸ§© æ¡Œé¢å°å·¥å…· (Widgets)**: åœ¨ iOS/Android ä¸»ç•«é¢ç›´æ¥æŸ¥çœ‹å³å°‡æ‰£æ¬¾é …ç›® (åŸºæ–¼ Expo Widget API)ã€‚

### ğŸ”§ å…·é«”å„ªåŒ–å·¥ç¨‹ (Engineering Improvements)

- [ ] **ğŸš€ çœŸãƒ»æ‡¶åŠ è¼‰ (True Lazy Loading)**: å°‡ `xlsx` èˆ‡ `firebase` æ”¹ç‚ºå‹•æ…‹å°å…¥ (`await import`)ï¼Œå„ªåŒ–å•Ÿå‹•é€Ÿåº¦ã€‚
- [ ] **âš¡ MMKV å„²å­˜å±¤**: æ›¿æ› `AsyncStorage`ï¼Œå¤§å¹…æå‡è®€å¯«æ•ˆèƒ½ã€‚
- [ ] **ğŸ›¡ï¸ å¼·å‹åˆ¥ i18n (Typed i18n)**: å»ºç«‹ç¿»è­¯ Key çš„å‹åˆ¥æª¢æŸ¥æ©Ÿåˆ¶ã€‚
- [ ] **â™¿ ç„¡éšœç¤™å„ªåŒ– (A11y)**: å¼•å…¥è‡ªå‹•åŒ–æª¢æ¸¬èˆ‡æ”¹å–„è¢å¹•é–±è®€å™¨é«”é©—ã€‚
- [ ] **ğŸ”„ React Query**: å¼•å…¥è³‡æ–™å¿«å–èˆ‡åŒæ­¥ç®¡ç†åº«ã€‚
- [ ] **ğŸ éŒ¯èª¤ç›£æ§ (Sentry Integration)**: æ•´åˆ Sentry SDK ä»¥è¿½è¹¤ç”Ÿç”¢ç’°å¢ƒçš„ Crash èˆ‡æ•ˆèƒ½å•é¡Œ (ç›®å‰ç¼ºå¸­)ã€‚
- [ ] **ğŸï¸ Context æ¸²æŸ“å„ªåŒ–**: ç‚º `DatabaseContext` èˆ‡ `AuthContext` çš„ `value` ç‰©ä»¶åŠ ä¸Š `useMemo`ï¼Œé˜²æ­¢éå¿…è¦çš„ Re-rendersã€‚
- [ ] **ğŸ›¡ï¸ ç’°å¢ƒè®Šæ•¸é©—è­‰ (Env Validation)**: å¼•å…¥ `zod` åœ¨å•Ÿå‹•æ™‚é©—è­‰ `process.env`ï¼Œé˜²æ­¢ç¼ºå°‘ Config å°è‡´çš„ Runtime Errorã€‚
- [ ] **ğŸ“± å¹³å°å·®ç•°åŒ–æ‹†åˆ† (Platform Resolution)**: é‡æ§‹ `src/services/index.ts`ï¼Œåˆ©ç”¨ `.native.ts` èˆ‡ `.web.ts` å¾Œç¶´æ©Ÿåˆ¶å–ä»£ Runtime Checkï¼Œç¸®æ¸› Bundle Size ä¸¦é¿å… Web ç«¯è¼‰å…¥ Native æ¨¡çµ„ã€‚

---

**Copyright Â© 2026 SubTrack. All rights reserved.**
